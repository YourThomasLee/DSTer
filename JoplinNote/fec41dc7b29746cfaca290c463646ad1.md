2.3.2 画像与特征

## 1. 画像

用户画像

* 用户ID
* 人口统计学属性：
* 账号信息
* 感兴趣的类目、关键词、品牌

物品画像：

* 物品ID
* 发布时间
* GeoHash（经纬度编码）
* 标题、类目、关键词、品牌
* 子树、图片数、视频清晰度、标签数
* 内容信息量、图片美学

用户统计特征

* 用户最近30天的曝光数、点击数、点赞数等等
* 按照笔记图文、视频分桶
* 按照笔记类目分桶

笔记统计特征

* 笔记最近30天的曝光数、点击数、收参数
* 按照用户性别分桶、按照用户年林分桶
* 作者特征：发布笔记数、粉丝数、消费指标

场景特征

* 用户地理定位
* 当前时刻
* 是否周末、节假日
* 手机品牌、手机型号、手机系统


特征处理

* 离散特征做embedding

  * 用户ID、笔记ID、作者ID
  * 类目、关键词、城市、手机品牌
* 连续特征：

  * 做分桶离散化，如年龄、笔记字数、视频长度等等
  * 其他变换：曝光数、点击数、点赞数数值过大做$log(1+x)$，处理异常值。转化为点击率、曝光率等等


## 2. 特征交叉

* 线性特征：特征加权求和

* 因式分解机(Factorized Machine, FM): 不仅加权求和，而且加入内权加权的和（二阶特征）。可以用低秩矩阵分解的方式降低参数量，加速计算。

* Deep & Cross Networks (DCN) 译作“深度交叉网络”，可以用于召回双塔模型、粗排三塔模型、精排模型。DCN 由一个深度网络和一个交叉网络组成，交叉网络的基本组成单元是交叉层 (Cross Layer)。用Cross Network（$x_l = x_0x_{l-1}^Tw_l + b_l + x_{l - 1}$）显式提取特征，每层都对特征交叉组合，随着层数增加组合的阶数也持续增加 [DCN V2: Improved deep & cross network and practical lessons for web-scale learning to rank systems]

* LHUC: 只能用于精排。起源是语音识别，后来被应用到推荐系统，快手将其称为 PPNet，现在已经在业界广泛落地。![image.png](:/6b24a58d76514f9e873c0218f6e78aa0)将LHUC用于推荐系统，门控神经网络（2 x sigmoid）的梯度不要传递到用户ID embedding特征，需要对其做 stop gradient。 [Learning hidden unit contributions for unsupervised acoustic model adaptation]
* SENET: 对离散特征做field-wise加权，例如用户ID embedding是64维的向量，那么这个算一个field。本质还是通过学习来做线性加权。  
  field间的特征交叉用可用bilinear cross: $f_{ij} = x_i^TW_{ij}x_j; \; f_{ij} = x_i^T\odot [W_{ij}x_j]$。  
  FiBiNet: SENet和bilinear cross的结合![image.png](:/e4e7628bf76548588ba22bd242df2be7)


## 3. 用户行为建模

lastN: 用户最近的$n$次交互的物品ID，对所有物品做embedding并对所有向量做平均

DIN模型：对lastN物品使用注意力机制线性加权替代简单平均


id: fec41dc7b29746cfaca290c463646ad1
parent_id: 03165f479e854c2ba1640e475e741709
created_time: 2023-03-25T10:09:45.287Z
updated_time: 2023-03-31T12:47:39.833Z
is_conflict: 0
latitude: 0.00000000
longitude: 0.00000000
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 1680266859574
user_created_time: 2023-03-25T10:09:45.287Z
user_updated_time: 2023-03-31T12:47:39.833Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
type_: 1